<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>钉钉中拦截左侧返回键</title>
    <url>/2021/03/15/%E9%92%89%E9%92%89%E4%B8%AD%E6%8B%A6%E6%88%AA%E5%B7%A6%E4%BE%A7%E8%BF%94%E5%9B%9E%E9%94%AE/</url>
    <content><![CDATA[<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>钉钉中如何拦截导航栏中左上角的返回键，其实钉钉有提供 jssdk 供开发者调用，但是这个拦截方法 android 端在单页面应用开发中有 bug，具体原因可参照这篇文章<br><a href="https://blog.csdn.net/weixin_42183524/article/details/105502935">钉钉微应用 Android 返回键自定义功能 兼容</a></p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>vue-router 中的<code>beforeRouteLeave</code>钩子可以完美解决这个问题，具体代码如下:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * 路由拦截</span><br><span class="line"> *&#x2F;</span><br><span class="line">beforeRouteLeave(to, from, next) &#123;</span><br><span class="line">  &#x2F;&#x2F; this.nextRoute为data中定义的字段 值为true、false</span><br><span class="line">  if (this.nextRoute) &#123;</span><br><span class="line">    next();</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">      &#x2F;&#x2F;</span><br><span class="line">      &#x2F;&#x2F;业务逻辑...</span><br><span class="line">      &#x2F;&#x2F;</span><br><span class="line">    next(false); &#x2F;&#x2F;next(false)可以阻止页面离开</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">  &#x2F;**</span><br><span class="line">   * 返回</span><br><span class="line">   *&#x2F;</span><br><span class="line">quitBack() &#123;</span><br><span class="line">  if (this.queryParams.isApp !&#x3D; 1) &#123;</span><br><span class="line">    this.nextRoute &#x3D; true;</span><br><span class="line">    this.$router.go(-1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>其实主体思路就是利用next(false)无法离开当前页面，然后再结合业务逻辑，将nextRoute标识改为true时，即可离开页面。   </p>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>钉钉</tag>
        <tag>vue</tag>
      </tags>
  </entry>
</search>
